# AIDAO 2024 Track 1 

https://contest.yandex.com/contest/68727/problems/

## Краткий обзор результатов ФМРТ
Функциональная магнитно-резонансная томография (ФМРТ) - это метод нейровизуализации, используемый для изучения мозговой активности путем измерения изменений кровотока. В отличие от стандартной МРТ, которая генерирует статичные изображения анатомии мозга, ФМРТ фиксирует динамические изменения нейронной активности с течением времени. Это достигается за счет использования сигнала, зависящего от уровня кислорода в крови (BOLD), который изменяется в зависимости от насыщения гемоглобина кислородом. Когда нейроны активны, они потребляют больше кислорода, что приводит к изменению магнитных свойств гемоглобина. Эти изменения могут быть обнаружены и визуализированы с помощью ФМРТ, что позволяет исследователям наблюдать, какие области мозга активны в ответ на определенные стимулы или задачи.

Данные, генерируемые с помощью ФМРТ, состоят из трехмерных изображений мозга, причем каждый воксель представляет собой небольшой участок мозговой ткани. Со временем эти вокселы генерируют временные ряды данных, отражающие изменения уровня кислорода в крови, образуя, по сути, четырехмерный набор данных (пространственный и временной). Исследователи могут дополнительно обработать эти данные, используя схемы парцелляции, которые объединяют вокселы в более крупные области интереса (ROI). Пространственное разрешение этих ROI обычно составляет от 30 до 500 компонентов, в зависимости от исследования. Кроме того, при извлечении временных рядов применяются различные стратегии снижения шума, чтобы уменьшить шум и улучшить качество сигнала.

Эти результирующие временные ряды не являются независимыми; вместо этого они образуют сложные модели функциональной организации мозга. Важно отметить, что эта функциональная организация различается у разных людей, и это явление, как было установлено, является устойчивым и достоверным. Исследования показали, что профиль подключения мозга человека остается неизменным при различных сеансах сканирования и даже при выполнении различных задач или во время отдыха. Это означает, что отпечаток подключения индивидуума является внутренним, что позволяет идентифицировать его на основе паттернов подключения мозга. Более поздние исследования показали, что даже короткие фрагменты данных ФМРТ — менее минуты — могут успешно идентифицировать людей, что еще раз подчеркивает уникальность и стабильность этих моделей взаимодействия.

Возможность надежной идентификации людей с помощью функциональной связи МРТ имеет важное значение для неврологии и персонализированной медицины. Делая выводы о функциях мозга на индивидуальном уровне, исследователи потенциально могут разрабатывать более персонализированные диагностические инструменты или вмешательства. Например, анализ того, насколько связи в мозге человека отличаются от типичных, может помочь в разработке стратегий лечения неврологических расстройств или снижения когнитивных способностей. Кроме того, функциональная связь может быть использована для прогнозирования поведенческих особенностей, рисков для психического здоровья или результатов обучения, что делает ее мощным инструментом как для научных исследований, так и для клинических применений.

## Задача
Цель: Разработать алгоритм, способный определять, принадлежат ли два заданных образца временных рядов ФМРТ одному и тому же человеку или нет. Эту задачу можно рассматривать как задачу сопоставления объектов, цель которой состоит в сравнении профилей двух сканирований мозга и определении того, соответствуют ли они одному и тому же человеку.

Проблемы:
Алгоритм должен учитывать различия в методах предварительной обработки, распределении данных по атласу мозга и состояниях глаз в разных выборках.
Несмотря на эти различия, алгоритм должен идентифицировать внутренние закономерности в функциональных связях мозга, которые стабильны в различных условиях и надежно соответствуют индивидуальным особенностям.

## Обзор данных:
Вам предоставляются немаркированные данные, для которых необходимо рассчитать маркировку. Всего для МРТ–сканирования было отобрано 20 объектов, для каждого объекта имеется 16 (2x2x2x2) представлений, соответствующих двум различным разделам мозгового атласа (Brainnetome и Schaefer200), умноженным на две разные стратегии сглаживания, умноженным на два сегмента последовательности сканирования, умноженным на две разные последовательности. Структура формы для набора данных выглядит следующим образом [20*16 объектов, 10 временных шагов из последовательности сканирования, 246 объектов в увеличенном атласе]. Обратите внимание, что поскольку используются два атласа с разным количеством разделов, некоторые массивы данных дополняются np.nan, чтобы форма данных была одинаковой.

Общедоступные тестовые данные:
Набор данных IHB: 10 субъектов

Частные тестовые данные:
Набор данных IHB: 10 субъектов



## Цель
Задача состоит в том, чтобы смоделировать реалистичный рабочий процесс исследования:

Ограничения при сборе данных: Сбор данных ФМРТ является сложной и дорогостоящей задачей, в результате чего создаются небольшие собственные наборы данных.

Вариативность наборов данных: Эти открытые наборы данных по своей сути отличаются от закрытых данных в таких аспектах, как тип сканера, географическое местоположение сбора данных и средний возраст участников. Такие аспекты моделируются путем выбора различных состояний мозга, временных последовательностей, агрегации на основе атласа. Основная цель состоит в разработке модели, способной идентифицировать человека с помощью ФМРТ в качестве "отпечатка пальца", который был бы согласован с различными возмущениями и аспектами данных.


https://github.com/atolstikov/aidao24/tree/main/qualifiers_track_1



## Решение (Лера)

**I способ**

Разделить на атласы, получить предсказания для отдельных атласов, вернуть предсказания на место, получить сабмит. Важно: при получении предсказания на каждом атласе обучаю модель на каждой фиче из 246, а потом объединяю предсказания как самый частовстречающийся объект. 

ПРОБЛЕМА: изначально кластеризуем на 20 объектов, а тут непонятно как из двух кластеризаций на 10 объектов объединить в 20 объектов.


**II способ**

Получить предсказания для всех объектов, получить сабмит. Важно: при получении предсказания обучаю модель на каждой фиче из 246, а потом объединяю предсказания как самый частовстречающийся объект.


