# Reduction Clusterizer

## Архитектура

Пайплайн модели выглядит следующим образом:
data -> FC matrices -> autoencoder -> Kmeans.

### FC matrices
На этом этапе находится матрица коэффициентов корреляции Пирсона между временными рядами каждой области интереса. Другими словами элемент $M_{i, j}$ будет коэффициентом корреляции Пирсона между временным рядом области $i$ и области $j$. Значения матрицы, находящиеся в верхнем треугольнике, распрямляются в один вектор и становятся атрибутами соответствующего объекта.

### Autoencoder
Автоинкодер генерирует небольшое количество фичей которые должны хорошо описывать данные и, в теории, позволять хорошо их разлечать.

### Kmeans
После нахождения 20 центроид алгоритм жадным образом выбирает для каждой центроиды 16 ближайших к ней объектов. Предсказывается что эти 16 объектов будут снимками одного человека.

## Как использовать

Для создания модели использовался DVC. Для подгрузки данных необходимо запулить их с удаленного хранилища коммандой dvc pull. Запустить обучение модели можно коммандой dvc repro. в файле model.pd будет храниться модель, в файле encoded_data.npy сгенерированные фичи, а в файле submission.csv разбиение объектов на классы.

Параметры модели можно регулировать через файл params.yaml.